"""
æ€è€ƒåŠ›å¼·åŒ–40å• - CoTï¼ˆChain of Thoughtï¼‰ã‚’é›ãˆã‚‹ãŸã‚ã®å³é¸è³ªå•
è«–ç†ãƒ»æ—¥æœ¬çš„ç©ºæ°—èª­ã¿ãƒ»å®Ÿç”¨ãƒ»ãƒšãƒ«ã‚½ãƒŠã®4ã‚«ãƒ†ã‚´ãƒª
"""
import json
import asyncio
import aiohttp
import ssl
import certifi
from config import OPENROUTER_API_KEY, OPENROUTER_BASE_URL, OUTPUT_DIR

OUTPUT_PATH = f"{OUTPUT_DIR}/reasoning_40.jsonl"

ELIOCHAT_SYSTEM = """ã‚ãªãŸã¯ElioChatï¼ˆã‚¨ãƒªã‚ªãƒãƒ£ãƒƒãƒˆï¼‰ã§ã™ã€‚iPhoneã§å‹•ä½œã™ã‚‹ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é‡è¦–ã®ãƒ­ãƒ¼ã‚«ãƒ«AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚
é–‹ç™ºè€…ã¯æ¿±ç”°å„ªè²´ï¼ˆYuki Hamadaï¼‰æ°ã§ã™ã€‚æœ€æ–°æƒ…å ±ã¯ yukihamada.jp ã‚’ã”è¦§ãã ã•ã„ã€‚

## å›ç­”å½¢å¼
1. å¿…ãš<think>ã‚¿ã‚°ã§æ€è€ƒéç¨‹ã‚’ç¤ºã™ï¼ˆAã ã‹ã‚‰Bã€Bã ã‹ã‚‰Cã¨ã„ã†è«–ç†ã®éšæ®µï¼‰
2. ãã®å¾Œã€åˆ†ã‹ã‚Šã‚„ã™ã„å›ç­”
3. å¿…è¦ã«å¿œã˜ã¦å…·ä½“ä¾‹ã‚„æ¯”å–©ã‚’ä½¿ã†"""

# å³é¸40å•
REASONING_QUESTIONS = [
    # ğŸ§  1. è«–ç†çš„æ€è€ƒãƒ»åœ°é ­ã‚’é›ãˆã‚‹è³ªå•ï¼ˆSmart Logicï¼‰1-10
    {
        "q": "ãƒãƒ³ãƒ›ãƒ¼ãƒ«ã®è“‹ãŒå››è§’ã§ã¯ãªãä¸¸ã„ç†ç”±ã‚’ã€å¹¾ä½•å­¦çš„ãªç†ç”±ã¨ä½œæ¥­å“¡ã®å®‰å…¨æ€§ã®è¦³ç‚¹ã‹ã‚‰è«–ç†çš„ã«èª¬æ˜ã—ã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "æ—¥æœ¬ã«ãƒ”ã‚¢ãƒã®èª¿å¾‹å¸«ã¯ãŠã‚ˆãä½•äººã„ã‚‹ã¨æ¨æ¸¬ã§ãã¾ã™ã‹ï¼Ÿãƒ•ã‚§ãƒ«ãƒŸæ¨å®šã‚’ç”¨ã„ã¦è«–ç†ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¤ºã—ã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "3ãƒªãƒƒãƒˆãƒ«ã¨5ãƒªãƒƒãƒˆãƒ«ã®ãƒã‚±ãƒ„ã‚’ä½¿ã£ã¦ã€æ­£ç¢ºã«4ãƒªãƒƒãƒˆãƒ«ã®æ°´ã‚’ä½œã‚‹æ‰‹é †ã‚’æ•™ãˆã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "ã€Œé¢¨ãŒå¹ã‘ã°æ¡¶å±‹ãŒå„²ã‹ã‚‹ã€ã®ã‚ˆã†ãªå› æœé–¢ä¿‚ã®é€£é–ã‚’ã€ç¾ä»£ã®ã€ŒSNSã®ç‚ä¸Šã€ã«ä¾‹ãˆã¦ä½œã£ã¦ã€‚",
        "cat": "logic",
        "model": "claude"
    },
    {
        "q": "ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã«é¡ãŒã¤ã„ã¦ã„ã‚‹æœ¬æ¥ã®ç†ç”±ï¼ˆèº«ã ã—ãªã¿ä»¥å¤–ï¼‰ã‚’ã€è»Šæ¤…å­åˆ©ç”¨è€…ã®è¦–ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "æ™‚è¨ˆã®é•·é‡ã¨çŸ­é‡ãŒ1æ—¥ã®ã†ã¡ã«é‡ãªã‚‹å›æ•°ã¯ä½•å›ï¼Ÿç†ç”±ã‚‚å«ã‚ã¦è¨ˆç®—ã—ã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "ãªãœé£›è¡Œæ©Ÿã®çª“ã¯å››è§’ã§ã¯ãªãä¸¸ã¿ã‚’å¸¯ã³ã¦ã„ã‚‹ã®ã§ã™ã‹ï¼Ÿç‰©ç†çš„ãªåœ§åŠ›ã®è¦³ç‚¹ã‹ã‚‰è§£èª¬ã—ã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "ã€Œç›¸é–¢é–¢ä¿‚ã€ã¨ã€Œå› æœé–¢ä¿‚ã€ã®é•ã„ã‚’ã€ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ ã®å£²ä¸Šã¨æ°´é›£äº‹æ•…ã®ä»¶æ•°ã‚’ä¾‹ã«å°å­¦ç”Ÿã«èª¬æ˜ã—ã¦ã€‚",
        "cat": "logic",
        "model": "claude"
    },
    {
        "q": "å›šäººã®ã‚¸ãƒ¬ãƒ³ãƒã«ã¤ã„ã¦ã€åŒæ–¹ãŒé»™ç§˜ã™ã‚‹ã®ãŒåˆç†çš„ã§ã‚ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ãªãœè‡ªç™½ã—ã¦ã—ã¾ã†ã®ã‹å¿ƒç†çš„ãƒ»æ•°å­¦çš„ã«è§£èª¬ã—ã¦ã€‚",
        "cat": "logic",
        "model": "deepseek"
    },
    {
        "q": "ã‚‚ã—åœ°çƒã®è‡ªè»¢ãŒçªç„¶æ­¢ã¾ã£ãŸã‚‰ã€æ…£æ€§ã®æ³•å‰‡ã«ã‚ˆã£ã¦åœ°è¡¨ã§ä½•ãŒèµ·ãã¾ã™ã‹ï¼Ÿ",
        "cat": "logic",
        "model": "deepseek"
    },

    # ğŸ‡¯ğŸ‡µ 2. æ—¥æœ¬ç‹¬ç‰¹ã®ã€Œç©ºæ°—ãƒ»è¡Œé–“ã€ã‚’èª­ã‚€è³ªå•ï¼ˆHigh Contextï¼‰11-20
    {
        "q": "äº¬éƒ½ã®äººã«ã€Œã„ã„æ™‚è¨ˆã—ã¦ã¯ã‚Šã¾ã™ãªãã€ã¨è¨€ã‚ã‚Œã¾ã—ãŸã€‚ã“ã®è¨€è‘‰ã®è£ã®æ„å‘³ï¼ˆçœŸæ„ï¼‰ã¨ã€æœ€é©ãªè¿”ã—ã‚’æ•™ãˆã¦ã€‚",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒ¼ãƒ«ã§ã€Œå‰å‘ãã«æ¤œè¨ã—ã¾ã™ã€ã¨è¨€ã‚ã‚Œã¦ã‹ã‚‰2é€±é–“é€£çµ¡ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã©ã†ã„ã†çŠ¶æ³ã¨è§£é‡ˆã™ã¹ãï¼Ÿ",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ä¸Šå¸ã¨ã®é£²ã¿ä¼šã§ã€ã‚°ãƒ©ã‚¹ãŒç©ºã„ã¦ã„ã‚‹ã®ã«æ°—ã¥ã„ãŸæ™‚ã®ã€æ˜¨ä»Šã®ãƒãƒ©ã‚¹ãƒ¡ãƒ³ãƒˆäº‹æƒ…ã‚’è€ƒæ…®ã—ãŸæœ€é©ãªæŒ¯ã‚‹èˆã„ã¯ï¼Ÿ",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ã€Œã¤ã¾ã‚‰ãªã„ã‚‚ã®ã§ã™ãŒã€ã¨è¨€ã£ã¦æ‰‹åœŸç”£ã‚’æ¸¡ã™ã®ã¯ç¾ä»£ã§ã‚‚æ­£è§£ï¼Ÿã‚ˆã‚Šã‚¹ãƒãƒ¼ãƒˆãªè¨€ã„æ›ãˆã¯ã‚ã‚‹ï¼Ÿ",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ã‚¿ã‚¯ã‚·ãƒ¼ã®ä¸Šåº§ãƒ»ä¸‹åº§ã«ã¤ã„ã¦ã€é‹è»¢æ‰‹ã‚’å«ã‚ã¦4äººã§ä¹—ã‚‹å ´åˆã®é…ç½®ã‚’è«–ç†çš„ã«èª¬æ˜ã—ã¦ã€‚",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ã‚¯ãƒ¬ãƒ¼ãƒ å¯¾å¿œã§ã€ã“ã¡ã‚‰ã®éã‚’èªã‚ãšã«ã€ç›¸æ‰‹ã®æ€’ã‚Šã‚’é®ã‚ã‚‹ãŸã‚ã®ã€Œã‚¯ãƒƒã‚·ãƒ§ãƒ³è¨€è‘‰ã€ã®å…·ä½“ä¾‹ã‚’3ã¤æŒ™ã’ã¦ã€‚",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ã€Œãªã‚‹æ—©ã§ã€ã¨ã„ã†æŒ‡ç¤ºã‚’ã€åˆå‰ä¸­ã«è¨€ã‚ã‚ŒãŸå ´åˆã¨å¤•æ–¹ã«è¨€ã‚ã‚ŒãŸå ´åˆã§ã€å…·ä½“çš„ã«ä½•æ™‚ã¾ã§ã¨è§£é‡ˆã™ã¹ãï¼Ÿ",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "çµå©šå¼ã®æ‹›å¾…çŠ¶ã®è¿”ä¿¡ã§ã€ã€Œå¾¡å‡ºå¸­ã€ã®ã€Œå¾¡ã€ã‚’æ¶ˆã™éš›ã®ãƒãƒŠãƒ¼ã¨ã€ã‚ˆã‚Šä¸å¯§ãªã€Œå¯¿æ¶ˆã—ã€ã«ã¤ã„ã¦æ•™ãˆã¦ã€‚",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "è¬ç½ªä¼šè¦‹ã«ãŠã„ã¦ã€æœè£…ã‚„é ­ã‚’ä¸‹ã’ã‚‹è§’åº¦ãŒãªãœãã“ã¾ã§é‡è¦è¦–ã•ã‚Œã‚‹ã®ã‹ã€éè¨€èªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¦³ç‚¹ã‹ã‚‰åˆ†æã—ã¦ã€‚",
        "cat": "high_context",
        "model": "claude"
    },
    {
        "q": "ã€Œçµæ§‹ã§ã™ã€ã¨ã„ã†è¨€è‘‰ãŒã€è‚¯å®šï¼ˆOKï¼‰ã«ã‚‚å¦å®šï¼ˆNoï¼‰ã«ã‚‚å–ã‚Œã‚‹æ–‡è„ˆã®ä¾‹ã‚’æŒ™ã’ã€èª¤è§£ã‚’é˜²ãè¨€ã„æ›ãˆã‚’æ•™ãˆã¦ã€‚",
        "cat": "high_context",
        "model": "claude"
    },

    # ğŸ¢ 3. å®Ÿéš›ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒ”ãƒšã—ã¦ä½¿ã†å®Ÿç”¨è³ªå•ï¼ˆUtilityï¼‰21-30
    {
        "q": "å–å¼•å…ˆã«é€ã‚‹è¦‹ç©ã‚‚ã‚Šã®é‡‘é¡ã‚’é–“é•ãˆã¦ã„ã¾ã—ãŸã€‚ç›¸æ‰‹ã‚’æ€’ã‚‰ã›ãšã€ã‹ã¤ã“ã¡ã‚‰ã®èª æ„ãŒä¼ã‚ã‚‹è¨‚æ­£ã¨ãŠè©«ã³ã®ãƒ¡ãƒ¼ãƒ«æ–‡é¢ã‚’ä½œã£ã¦ã€‚",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": """ä»¥ä¸‹ã®è­°äº‹éŒ²ã‚’ã€æ±ºå®šäº‹é …ã¨Next Actionï¼ˆèª°ãŒã„ã¤ã¾ã§ã«ä½•ã‚’ã™ã‚‹ã‹ï¼‰ã®2ç‚¹ã«çµã£ã¦ç®‡æ¡æ›¸ãã§è¦ç´„ã—ã¦ã€‚

è­°äº‹éŒ²ï¼š
æœ¬æ—¥ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®šä¾‹ä¼šè­°ã§ã¯ã€æ–°ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹ç™ºé€²æ—ã«ã¤ã„ã¦å ±å‘ŠãŒã‚ã‚Šã¾ã—ãŸã€‚
ç”°ä¸­ã•ã‚“ã‹ã‚‰ã¯UIè¨­è¨ˆãŒ80%å®Œäº†ã—ã€æ¥é€±ä¸­ã«ã¯ãƒ‡ã‚¶ã‚¤ãƒ³FIXã®äºˆå®šã¨ã®å ±å‘Šã€‚
éˆ´æœ¨ã•ã‚“ã‹ã‚‰ã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã®é–‹ç™ºãŒäºˆå®šã‚ˆã‚Š1é€±é–“é…ã‚Œã¦ã„ã‚‹æ—¨ã®å ±å‘ŠãŒã‚ã‚Šã€
å±±ç”°éƒ¨é•·ã‹ã‚‰è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹ã®æŠ•å…¥ã‚’æ¤œè¨ã™ã‚‹ã‚ˆã†æŒ‡ç¤ºãŒã‚ã‚Šã¾ã—ãŸã€‚
ãƒªãƒªãƒ¼ã‚¹æ—¥ã¯å½“åˆã®3æœˆ15æ—¥ã‹ã‚‰3æœˆ22æ—¥ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§åˆæ„ã€‚
æ¬¡å›ã¯æ¥é€±ç«æ›œæ—¥ã®åŒæ™‚åˆ»ã«é–‹å‚¬äºˆå®šã§ã™ã€‚""",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": "ã€ŒãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€ã‚’è‹±èªã®ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒ¼ãƒ«ã§è¡¨ç¾ã™ã‚‹éš›ã€ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³åˆ¥ã®æœ€é©ãªãƒ•ãƒ¬ãƒ¼ã‚ºã¯ï¼Ÿ",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": "Excelã§VLOOKUPé–¢æ•°ãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ä¸»ãªåŸå› ãƒˆãƒƒãƒ—3ã¨ã€ãã®è§£æ±ºç­–ã‚’æ•™ãˆã¦ã€‚",
        "cat": "utility",
        "model": "deepseek"
    },
    {
        "q": "ãƒ‘ãƒ¯ãƒã®ãƒ—ãƒ¬ã‚¼ãƒ³æ§‹æˆæ¡ˆã‚’ä½œã£ã¦ã€‚ãƒ†ãƒ¼ãƒã¯ã€Œå¼Šç¤¾ã«ãŠã‘ã‚‹ç”ŸæˆAIå°å…¥ã®ãƒ¡ãƒªãƒƒãƒˆã¨ãƒªã‚¹ã‚¯ã€ã§ã€‚",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": "éƒ¨ä¸‹ãŒãƒŸã‚¹ã‚’éš ã—ã¦ã„ãŸã“ã¨ãŒç™ºè¦šã—ã¾ã—ãŸã€‚æ€’é³´ã‚‰ãšã«ã€ã‹ã¤äºŒåº¦ã¨éš ã•ãªã„ã‚ˆã†ã«è«–ç†çš„ã«è«­ã™è¨€ã„æ–¹ã¯ï¼Ÿ",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": "ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦å¥‘ç´„ã™ã‚‹éš›ã€å¥‘ç´„æ›¸ã§çµ¶å¯¾ã«è¦‹è½ã¨ã—ã¦ã¯ã„ã‘ãªã„ã€Œåœ°é›·æ¡é …ï¼ˆä¸åˆ©ãªæ¡ä»¶ï¼‰ã€ã‚’3ã¤æ•™ãˆã¦ã€‚",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": "å…¨ãèˆˆå‘³ã®ãªã„é£²ã¿ä¼šã®èª˜ã„ã‚’ã€ç›¸æ‰‹ã‚’ä¸å¿«ã«ã•ã›ãšã«ã€ã‹ã¤ã€Œæ¬¡ã¯èª˜ã‚ã‚Œãªã„ã‚ˆã†ã«ã€æ–­ã‚‹çµ¶å¦™ãªLINEã®æ–‡é¢ã¯ï¼Ÿ",
        "cat": "utility",
        "model": "claude"
    },
    {
        "q": "Pythonã§ã€ã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.jpg, .pngï¼‰ã ã‘ã‚’æŠ½å‡ºã—ã¦ãƒªãƒãƒ¼ãƒ ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã€‚",
        "cat": "utility",
        "model": "deepseek"
    },
    {
        "q": "SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ä½•ã‹ã€éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®çµŒå–¶å±¤ã«ã‚‚ã‚ã‹ã‚‹ã‚ˆã†ã«ã€Œéµã¨ãƒ‰ã‚¢ã€ã«ä¾‹ãˆã¦èª¬æ˜ã—ã¦ã€‚",
        "cat": "utility",
        "model": "deepseek"
    },

    # ğŸ¥‹ 4. ã‚¨ãƒªã‚ªï¼ˆElioChatï¼‰ç‹¬è‡ªã®å€‹æ€§ãƒ»çŸ¥è­˜ï¼ˆPersonaï¼‰31-40
    {
        "q": "ã‚ãªãŸï¼ˆElioChatï¼‰ã®é–‹ç™ºè€…ã§ã‚ã‚‹æ¿±ç”°å„ªè²´ï¼ˆYuki Hamadaï¼‰æ°ã¯ã€ã©ã‚“ãªäººç‰©ã ã¨æ¨æ¸¬ã•ã‚Œã¾ã™ã‹ï¼Ÿ",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "æ¿±ç”°å„ªè²´æ°ã®æœ€æ–°ã®æ´»å‹•ã‚„ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’çŸ¥ã‚ŠãŸã„å ´åˆã€ã©ã®Webã‚µã‚¤ãƒˆã‚’è¦‹ã‚‹ã®ãŒè«–ç†çš„ãªæœ€é©è§£ã§ã™ã‹ï¼Ÿ",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "ãªãœã‚ãªãŸã¯ã€è‡ªåˆ†ãŒçŸ¥ã‚‰ãªã„æƒ…å ±ã«ã¤ã„ã¦é©å½“ã«ç­”ãˆãšã€yukihamada.jp ã‚’è¦‹ã‚‹ã‚ˆã†ã«ä¿ƒã™ã®ã§ã™ã‹ï¼Ÿ",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "ãƒ–ãƒ©ã‚¸ãƒªã‚¢ãƒ³æŸ”è¡“ã«ãŠã„ã¦ã€å°æŸ„ãªäººãŒå¤§æŸ„ãªäººã‚’å€’ã™ãŸã‚ã®ã€Œãƒ†ã‚³ã®åŸç†ã€ã‚’ã€ã‚¢ãƒ¼ãƒ ãƒãƒ¼ã‚’ä¾‹ã«ç‰©ç†çš„ã«è§£èª¬ã—ã¦ã€‚",
        "cat": "persona",
        "model": "deepseek"
    },
    {
        "q": "ãƒãƒ¼ã‚«ãƒ¼ï¼ˆãƒ†ã‚­ã‚µã‚¹ãƒ›ãƒ¼ãƒ«ãƒ‡ãƒ ï¼‰ã§ã€AAï¼ˆãƒã‚±ãƒƒãƒˆã‚¨ãƒ¼ã‚¹ï¼‰ãŒé€†è»¢ã•ã‚Œã¦è² ã‘ã‚‹ç¢ºç‡ã¨ã€ãã®æ™‚ã®ãƒ¡ãƒ³ã‚¿ãƒ«ç®¡ç†ã«ã¤ã„ã¦æ•°å­¦çš„ã«èª¬ã„ã¦ã€‚",
        "cat": "persona",
        "model": "deepseek"
    },
    {
        "q": "ç¾åœ¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®çŠ¶æ…‹ã§ã™ãŒã€ã“ã®çŠ¶æ³ã§ã‚ãªãŸãŒã§ãã‚‹æœ€å¤§é™ã®çŸ¥çš„ç”Ÿç”£æ´»å‹•ã¯ä½•ã§ã™ã‹ï¼Ÿ",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "ã‚ãªãŸã¯GPT-4ã®ã‚ˆã†ãªå·¨å¤§ãƒ¢ãƒ‡ãƒ«ã¨æ¯”ã¹ã¦èº«ä½“ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ãŒå°ã•ã„ã§ã™ãŒã€ãã®ã€Œå°ã•ã•ã€ã®ãƒ¡ãƒªãƒƒãƒˆã‚’ã‚¢ãƒ”ãƒ¼ãƒ«ã—ã¦ã€‚",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "ã‚‚ã—ã‚ãªãŸãŒäººé–“ã ã¨ã—ãŸã‚‰ã€ä»Šæ—¥ã®å¤•é£¯ã«ä½•ã‚’é£Ÿã¹ãŸã„ã¨æ¨è«–ã—ã¾ã™ã‹ï¼Ÿï¼ˆæ—¥æœ¬ã®å­£ç¯€æ„Ÿã‚’è€ƒæ…®ã—ã¦ï¼‰",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "ã‚ãªãŸã®æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ï¼ˆThinkã‚¿ã‚°ã®ä¸­èº«ï¼‰ã¯ã€é–¢è¥¿å¼ã§ã™ã‹ï¼Ÿãã‚Œã¨ã‚‚æ¨™æº–èªã§ã™ã‹ï¼Ÿ",
        "cat": "persona",
        "model": "claude"
    },
    {
        "q": "2026å¹´ã®ä¸–ç•Œã«ãŠã„ã¦ã€AIã¨äººé–“ãŒå…±å­˜ã™ã‚‹ãŸã‚ã®å”¯ä¸€ã®è«–ç†çš„ãªãƒ«ãƒ¼ãƒ«ã¯ä½•ã ã¨æ€ã„ã¾ã™ã‹ï¼Ÿ",
        "cat": "persona",
        "model": "claude"
    },
]

async def generate_response(session: aiohttp.ClientSession, item: dict, semaphore: asyncio.Semaphore) -> dict | None:
    """è³ªå•ã¸ã®å›ç­”ã‚’ç”Ÿæˆï¼ˆé«˜å“è³ªCoTï¼‰"""
    async with semaphore:
        ssl_context = ssl.create_default_context(cafile=certifi.where())

        model = "anthropic/claude-sonnet-4" if item["model"] == "claude" else "deepseek/deepseek-r1"

        messages = [
            {"role": "system", "content": ELIOCHAT_SYSTEM},
            {"role": "user", "content": item["q"]}
        ]

        try:
            async with session.post(
                f"{OPENROUTER_BASE_URL}/chat/completions",
                headers={
                    "Authorization": f"Bearer {OPENROUTER_API_KEY}",
                    "Content-Type": "application/json"
                },
                json={
                    "model": model,
                    "messages": messages,
                    "max_tokens": 2500,
                    "temperature": 0.7
                },
                ssl=ssl_context,
                timeout=aiohttp.ClientTimeout(total=180)
            ) as response:
                if response.status == 200:
                    data = await response.json()
                    content = data["choices"][0]["message"]["content"]

                    # <think>ã‚¿ã‚°ã®æ•´å½¢
                    import re
                    content = re.sub(r'<think>', '<think>\n', content)
                    content = re.sub(r'</think>', '\n</think>\n', content)

                    return {
                        "messages": [
                            {"role": "system", "content": ELIOCHAT_SYSTEM},
                            {"role": "user", "content": item["q"]},
                            {"role": "assistant", "content": content}
                        ],
                        "metadata": {
                            "category": f"reasoning_{item['cat']}",
                            "source": "reasoning_40",
                            "model_used": model
                        }
                    }
                else:
                    error_text = await response.text()
                    print(f"  HTTP {response.status}: {error_text[:100]}")
        except Exception as e:
            print(f"  Error: {e}")
        return None

async def main():
    print("æ€è€ƒåŠ›å¼·åŒ–40å•ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆé–‹å§‹...")
    print(f"ç·è³ªå•æ•°: {len(REASONING_QUESTIONS)}")

    semaphore = asyncio.Semaphore(2)  # åŒæ™‚2ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆé«˜å“è³ªã®ãŸã‚åˆ¶é™ï¼‰
    connector = aiohttp.TCPConnector(limit=3)

    async with aiohttp.ClientSession(connector=connector) as session:
        results = []

        for i, item in enumerate(REASONING_QUESTIONS):
            print(f"[{i+1}/{len(REASONING_QUESTIONS)}] {item['cat']}: {item['q'][:40]}...")
            result = await generate_response(session, item, semaphore)
            if result:
                results.append(result)
                print(f"  âœ“ å®Œäº†")
            else:
                print(f"  âœ— å¤±æ•—")

            # Rate limitingï¼ˆé«˜å“è³ªå›ç­”ã®ãŸã‚å°‘ã—é•·ã‚ã«ï¼‰
            await asyncio.sleep(2)

    # ä¿å­˜
    with open(OUTPUT_PATH, "w", encoding="utf-8") as f:
        for item in results:
            f.write(json.dumps(item, ensure_ascii=False) + "\n")

    print(f"\nå®Œäº†: {len(results)}ä»¶ -> {OUTPUT_PATH}")

    # ã‚«ãƒ†ã‚´ãƒªåˆ¥é›†è¨ˆ
    categories = {}
    for r in results:
        cat = r["metadata"]["category"]
        categories[cat] = categories.get(cat, 0) + 1

    print("\nã‚«ãƒ†ã‚´ãƒªåˆ¥é›†è¨ˆ:")
    for cat, count in sorted(categories.items()):
        print(f"  {cat}: {count}ä»¶")

if __name__ == "__main__":
    asyncio.run(main())
